<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="referrer" content="no-referrer" />
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha256-5eIC48iZUHmSlSUz9XtjRyK2mzQkHScZY1WdMaoz74E=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"patr1ck-s.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.21.1","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"hljswrap":true,"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"duration":200,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="前言：当时应该是去打西湖了 就没怎么看day2的题 现在来复现一下 skipjadx打开附件 发现需要输入用户名和密码">
<meta property="og:type" content="article">
<meta property="og:title" content="2024 春秋杯冬季赛 DAY2 RE wp">
<meta property="og:url" content="http://patr1ck-s.github.io/2025/02/08/2024-%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B-DAY2-RE-wp/index.html">
<meta property="og:site_name" content="Patr1ck&#39;s blog">
<meta property="og:description" content="前言：当时应该是去打西湖了 就没怎么看day2的题 现在来复现一下 skipjadx打开附件 发现需要输入用户名和密码">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp-12.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp-13.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp-15.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp-14.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp-16.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp-17.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ckday2wp-17.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ckday2wp-18.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ckday2wp-19.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ckday2wp-20.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ckday2wp-21.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ckday2wp-22.png">
<meta property="og:image" content="http://patr1ck-s.github.io/images/Patr1ckday2wp-23.png">
<meta property="article:published_time" content="2025-02-08T12:44:39.000Z">
<meta property="article:modified_time" content="2025-02-08T12:59:07.277Z">
<meta property="article:author" content="Patr1ck">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://patr1ck-s.github.io/images/Patr1ck-day2-wp-12.png">


<link rel="canonical" href="http://patr1ck-s.github.io/2025/02/08/2024-%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B-DAY2-RE-wp/">


<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://patr1ck-s.github.io/2025/02/08/2024-%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B-DAY2-RE-wp/","path":"2025/02/08/2024-春秋杯冬季赛-DAY2-RE-wp/","title":"2024 春秋杯冬季赛 DAY2 RE wp"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2024 春秋杯冬季赛 DAY2 RE wp | Patr1ck's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Patr1ck's blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
      <div class="search-header">
        <span class="search-icon">
          <i class="fa fa-search"></i>
        </span>
        <div class="search-input-container">
          <input autocomplete="off" autocapitalize="off" maxlength="80"
                placeholder="搜索..." spellcheck="false"
                type="search" class="search-input">
        </div>
        <span class="popup-btn-close" role="button">
          <i class="fa fa-times-circle"></i>
        </span>
      </div>
      <div class="search-result-container">
        <div class="search-result-icon">
          <i class="fa fa-spinner fa-pulse fa-5x"></i>
        </div>
      </div>
    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#skip"><span class="nav-number">1.</span> <span class="nav-text">skip</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Nu1tka"><span class="nav-number">2.</span> <span class="nav-text">Nu1tka</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Patr1ck"
      src="/images/yzbpdx.png">
  <p class="site-author-name" itemprop="name">Patr1ck</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://patr1ck-s.github.io/2025/02/08/2024-%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B-DAY2-RE-wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/yzbpdx.png">
      <meta itemprop="name" content="Patr1ck">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Patr1ck's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2024 春秋杯冬季赛 DAY2 RE wp | Patr1ck's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2024 春秋杯冬季赛 DAY2 RE wp
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2025-02-08 20:44:39 / 修改时间：20:59:07" itemprop="dateCreated datePublished" datetime="2025-02-08T20:44:39+08:00">2025-02-08</time>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>20k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>18 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p><strong>前言：当时应该是去打西湖了 就没怎么看day2的题 现在来复现一下</strong></p>
<h1 id="skip"><a href="#skip" class="headerlink" title="skip"></a>skip</h1><p>jadx打开附件 发现需要输入用户名和密码</p>
<span id="more"></span>

<p><img src="/../images/Patr1ck-day2-wp-12.png" alt="Patr1ck-day2-wp-12"></p>
<p>用户名校验的部分在native层 密码被加密算法skip32加密 直接看so先找一下用户名</p>
<p><img src="/../images/Patr1ck-day2-wp.png" alt="Patr1ck-day2-wp"></p>
<p>跟进encrypt可以看出是一个DES 修改了sbox</p>
<p><img src="/../images/Patr1ck-day2-wp-13.png" alt="Patr1ck-day2-wp-13"></p>
<p>密文密钥已知 直接本地找个DES的脚本解一下</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line"></span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">typedef unsigned char ubyte;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">#define KEY_LEN 8</span><br><span class="line"></span><br><span class="line">typedef ubyte key_t[KEY_LEN];</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte PC1[] = &#123;</span><br><span class="line"></span><br><span class="line">    57, 49, 41, 33, 25, 17,  9,</span><br><span class="line"></span><br><span class="line">    1, 58, 50, 42, 34, 26, 18,</span><br><span class="line"></span><br><span class="line">    10,  2, 59, 51, 43, 35, 27,</span><br><span class="line"></span><br><span class="line">    19, 11,  3, 60, 52, 44, 36,</span><br><span class="line"></span><br><span class="line">    63, 55, 47, 39, 31, 23, 15,</span><br><span class="line"></span><br><span class="line">    7, 62, 54, 46, 38, 30, 22,</span><br><span class="line"></span><br><span class="line">    14,  6, 61, 53, 45, 37, 29,</span><br><span class="line"></span><br><span class="line">    21, 13,  5, 28, 20, 12,  4</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte PC2[] = &#123;</span><br><span class="line"></span><br><span class="line">    14, 17, 11, 24,  1,  5,</span><br><span class="line"></span><br><span class="line">    3, 28, 15,  6, 21, 10,</span><br><span class="line"></span><br><span class="line">    23, 19, 12,  4, 26,  8,</span><br><span class="line"></span><br><span class="line">    16,  7, 27, 20, 13,  2,</span><br><span class="line"></span><br><span class="line">    41, 52, 31, 37, 47, 55,</span><br><span class="line"></span><br><span class="line">    30, 40, 51, 45, 33, 48,</span><br><span class="line"></span><br><span class="line">    44, 49, 39, 56, 34, 53,</span><br><span class="line"></span><br><span class="line">    46, 42, 50, 36, 29, 32</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte IP[] = &#123;</span><br><span class="line"></span><br><span class="line">    58, 50, 42, 34, 26, 18, 10,  2,</span><br><span class="line"></span><br><span class="line">    60, 52, 44, 36, 28, 20, 12,  4,</span><br><span class="line"></span><br><span class="line">    62, 54, 46, 38, 30, 22, 14,  6,</span><br><span class="line"></span><br><span class="line">    64, 56, 48, 40, 32, 24, 16,  8,</span><br><span class="line"></span><br><span class="line">    57, 49, 41, 33, 25, 17,  9,  1,</span><br><span class="line"></span><br><span class="line">    59, 51, 43, 35, 27, 19, 11,  3,</span><br><span class="line"></span><br><span class="line">    61, 53, 45, 37, 29, 21, 13,  5,</span><br><span class="line"></span><br><span class="line">    63, 55, 47, 39, 31, 23, 15,  7</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte E[] = &#123;</span><br><span class="line"></span><br><span class="line">    32,  1,  2,  3,  4,  5,</span><br><span class="line"></span><br><span class="line">    4,  5,  6,  7,  8,  9,</span><br><span class="line"></span><br><span class="line">    8,  9, 10, 11, 12, 13,</span><br><span class="line"></span><br><span class="line">    12, 13, 14, 15, 16, 17,</span><br><span class="line"></span><br><span class="line">    16, 17, 18, 19, 20, 21,</span><br><span class="line"></span><br><span class="line">    20, 21, 22, 23, 24, 25,</span><br><span class="line"></span><br><span class="line">    24, 25, 26, 27, 28, 29,</span><br><span class="line"></span><br><span class="line">    28, 29, 30, 31, 32,  1</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte S[][64] = &#123;</span><br><span class="line"></span><br><span class="line">    &#123;</span><br><span class="line"></span><br><span class="line">        6, 6, 4, 9, 6, 7, 4, 11, 0, 2, 8, 12, 10, 8, 0, 1, 12, 6, 9, 9, 3, 7, 11, 5, 4, 13, 1, 3, 15, 8, 10, 13, 5, 13, 10, 2, 12, 0, 14, 13, 11, 14, 5, 3, 2, 8, 14, 3, 14, 4, 11, 7, 15, 5, 1, 7, 1, 12, 9, 0, 10, 2, 15, 15</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        10, 2, 4, 8, 12, 15, 3, 10, 4, 8, 3, 4, 14, 5, 7, 15, 15, 8, 0, 7, 9, 4, 13, 0, 5, 8, 11, 14, 6, 2, 2, 6, 13, 9, 2, 3, 10, 7, 1, 9, 5, 15, 1, 11, 9, 14, 13, 11, 7, 12, 12, 5, 1, 10, 14, 6, 6, 0, 0, 12, 3, 1, 11, 13</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        10, 0, 0, 6, 5, 13, 9, 14, 3, 1, 1, 8, 13, 9, 8, 15, 12, 7, 1, 3, 15, 7, 11, 7, 5, 10, 3, 10, 2, 6, 8, 10, 9, 3, 2, 14, 14, 11, 11, 2, 13, 15, 7, 6, 8, 4, 4, 12, 0, 1, 14, 5, 12, 12, 4, 2, 6, 9, 4, 5, 11, 15, 0, 13</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        6, 12, 1, 11, 14, 0, 4, 4, 4, 2, 15, 3, 3, 1, 1, 2, 8, 0, 9, 6, 0, 8, 13, 2, 12, 3, 3, 10, 7, 15, 12, 8, 15, 14, 7, 4, 6, 14, 1, 7, 7, 9, 6, 9, 15, 5, 11, 0, 10, 13, 13, 9, 13, 5, 5, 11, 12, 11, 8, 2, 5, 10, 14, 10</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        5, 5, 7, 9, 9, 13, 0, 5, 6, 11, 12, 5, 4, 15, 0, 12, 11, 13, 13, 10, 8, 2, 13, 3, 3, 14, 14, 6, 9, 3, 0, 7, 10, 9, 7, 8, 10, 2, 1, 0, 6, 14, 15, 8, 14, 15, 2, 1, 7, 6, 15, 10, 3, 12, 12, 4, 1, 8, 4, 11, 2, 1, 11, 4</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        14, 6, 14, 6, 0, 13, 9, 5, 5, 11, 0, 7, 2, 3, 0, 0, 3, 13, 8, 2, 15, 9, 1, 7, 9, 1, 12, 4, 10, 9, 8, 11, 4, 1, 6, 15, 12, 14, 11, 2, 5, 14, 13, 4, 3, 7, 1, 15, 11, 10, 3, 7, 8, 8, 15, 5, 12, 12, 10, 10, 4, 6, 13, 2</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        15, 14, 10, 3, 3, 15, 12, 14, 0, 2, 14, 12, 8, 0, 5, 6, 14, 2, 0, 1, 8, 1, 13, 4, 11, 4, 7, 11, 9, 15, 1, 12, 5, 0, 7, 13, 6, 10, 6, 12, 11, 6, 13, 3, 8, 4, 9, 9, 13, 4, 2, 5, 1, 7, 9, 5, 7, 2, 8, 15, 3, 10, 10, 11</span><br><span class="line"></span><br><span class="line">&#125;,</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">        4, 7, 4, 15, 0, 5, 9, 14, 8, 11, 13, 0, 7, 3, 1, 2, 1, 6, 7, 5, 12, 4, 13, 13, 8, 1, 5, 12, 11, 9, 5, 11, 6, 10, 3, 1, 15, 14, 14, 15, 9, 9, 15, 2, 12, 12, 14, 0, 4, 8, 6, 3, 11, 7, 3, 6, 10, 2, 0, 2, 8, 10, 10, 13</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte P[] = &#123;</span><br><span class="line"></span><br><span class="line">    16,  7, 20, 21,</span><br><span class="line"></span><br><span class="line">    29, 12, 28, 17,</span><br><span class="line"></span><br><span class="line">    1, 15, 23, 26,</span><br><span class="line"></span><br><span class="line">    5, 18, 31, 10,</span><br><span class="line"></span><br><span class="line">    2,  8, 24, 14,</span><br><span class="line"></span><br><span class="line">    32, 27,  3,  9,</span><br><span class="line"></span><br><span class="line">    19, 13, 30,  6,</span><br><span class="line"></span><br><span class="line">    22, 11,  4, 25</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte IP2[] = &#123;</span><br><span class="line"></span><br><span class="line">    40,  8, 48, 16, 56, 24, 64, 32,</span><br><span class="line"></span><br><span class="line">    39,  7, 47, 15, 55, 23, 63, 31,</span><br><span class="line"></span><br><span class="line">    38,  6, 46, 14, 54, 22, 62, 30,</span><br><span class="line"></span><br><span class="line">    37,  5, 45, 13, 53, 21, 61, 29,</span><br><span class="line"></span><br><span class="line">    36,  4, 44, 12, 52, 20, 60, 28,</span><br><span class="line"></span><br><span class="line">    35,  3, 43, 11, 51, 19, 59, 27,</span><br><span class="line"></span><br><span class="line">    34,  2, 42, 10, 50, 18, 58, 26,</span><br><span class="line"></span><br><span class="line">    33,  1, 41,  9, 49, 17, 57, 25</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">const static ubyte SHIFTS[] = &#123;</span><br><span class="line"></span><br><span class="line">    1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">typedef struct &#123;</span><br><span class="line"></span><br><span class="line">    ubyte *data;</span><br><span class="line"></span><br><span class="line">    int len;</span><br><span class="line"></span><br><span class="line">&#125; String;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Transform a single nibble into a hex character</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* in: a value &lt; 0x10</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* returns: the character that represents the nibble</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">static char toHex(ubyte in) &#123;</span><br><span class="line"></span><br><span class="line">    if (0x00 &lt;= in &amp;&amp; in &lt; 0x0A) &#123;</span><br><span class="line"></span><br><span class="line">        return &#x27;0&#x27; + in;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (0x0A &lt;= in &amp;&amp; in &lt;= 0x0F) &#123;</span><br><span class="line"></span><br><span class="line">        return &#x27;A&#x27; + in - 0x0A;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Convert an array of bytes into a string</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* ptr: the array of bytes</span><br><span class="line"></span><br><span class="line">* len: the number of bytes</span><br><span class="line"></span><br><span class="line">* out: a buffer allocated by the caller with enough space for 2*len+1 characters</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">static void printBytes(const ubyte *ptr, int len, char *out) &#123;</span><br><span class="line"></span><br><span class="line">    while (len-- &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">        *out++ = toHex(*ptr &gt;&gt; 4);</span><br><span class="line"></span><br><span class="line">        *out++ = toHex(*ptr &amp; 0x0F);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        ptr++;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    *out = 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Gets the value of a bit in an array of bytes</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* src: the array of bytes to index</span><br><span class="line"></span><br><span class="line">* index: the desired bit to test the value of</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* returns: the bit at the specified position in the array</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">static int peekBit(const ubyte *src, int index) &#123;</span><br><span class="line"></span><br><span class="line">    int cell = index / 8;</span><br><span class="line"></span><br><span class="line">    int bit = 7 - index % 8;</span><br><span class="line"></span><br><span class="line">    return (src[cell] &amp; (1 &lt;&lt; bit)) != 0;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Sets the value of a bit in an array of bytes</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* dst: the array of bits to set a bit in</span><br><span class="line"></span><br><span class="line">* index: the position of the bit to set</span><br><span class="line"></span><br><span class="line">* value: the value for the bit to set</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">static void pokeBit(ubyte *dst, int index, int value) &#123;</span><br><span class="line"></span><br><span class="line">    int cell = index / 8;</span><br><span class="line"></span><br><span class="line">    int bit = 7 - index % 8;</span><br><span class="line"></span><br><span class="line">    if (value == 0) &#123;</span><br><span class="line"></span><br><span class="line">        dst[cell] &amp;= ~(1 &lt;&lt; bit);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    else &#123;</span><br><span class="line"></span><br><span class="line">        dst[cell] |= (1 &lt;&lt; bit);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Transforms one array of bytes by shifting the bits the specified number of positions</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* src: the array to shift bits from</span><br><span class="line"></span><br><span class="line">* len: the length of the src array</span><br><span class="line"></span><br><span class="line">* times: the number of positions that the bits should be shifted</span><br><span class="line"></span><br><span class="line">* dst: a bytes array allocated by the caller to store the shifted values</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">static void shiftLeft(const ubyte *src, int len, int times, ubyte *dst) &#123;</span><br><span class="line"></span><br><span class="line">    int i, t;</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt;= len; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(dst, i, peekBit(src, i));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (t = 1; t &lt;= times; ++t) &#123;</span><br><span class="line"></span><br><span class="line">        int temp = peekBit(dst, 0);</span><br><span class="line"></span><br><span class="line">        for (i = 1; i &lt;= len; ++i) &#123;</span><br><span class="line"></span><br><span class="line">            pokeBit(dst, i - 1, peekBit(dst, i));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        pokeBit(dst, len - 1, temp);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Calculates the sub keys to be used in processing the messages</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* key: the array of bytes representing the key</span><br><span class="line"></span><br><span class="line">* ks: the subkeys that have been allocated by the caller</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">typedef ubyte subkey_t[17][6]; /* 17 sets of 48 bits */</span><br><span class="line"></span><br><span class="line">static void getSubKeys(const key_t key, subkey_t ks) &#123;</span><br><span class="line"></span><br><span class="line">    ubyte c[17][7];  /* 56 bits */</span><br><span class="line"></span><br><span class="line">    ubyte d[17][4];  /* 28 bits */</span><br><span class="line"></span><br><span class="line">    ubyte kp[7];</span><br><span class="line"></span><br><span class="line">    int i, j;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* intialize */</span><br><span class="line"></span><br><span class="line">    memset(c, 0, sizeof(c));</span><br><span class="line"></span><br><span class="line">    memset(d, 0, sizeof(d));</span><br><span class="line"></span><br><span class="line">    memset(ks, 0, sizeof(subkey_t));</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* permute &#x27;key&#x27; using table PC1 */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 56; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(kp, i, peekBit(key, PC1[i] - 1));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* split &#x27;kp&#x27; in half and process the resulting series of &#x27;c&#x27; and &#x27;d&#x27; */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 28; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(c[0], i, peekBit(kp, i));</span><br><span class="line"></span><br><span class="line">        pokeBit(d[0], i, peekBit(kp, i + 28));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* shift the components of c and d */</span><br><span class="line"></span><br><span class="line">    for (i = 1; i &lt; 17; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        shiftLeft(c[i - 1], 28, SHIFTS[i - 1], c[i]);</span><br><span class="line"></span><br><span class="line">        shiftLeft(d[i - 1], 28, SHIFTS[i - 1], d[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* merge &#x27;d&#x27; into &#x27;c&#x27; */</span><br><span class="line"></span><br><span class="line">    for (i = 1; i &lt; 17; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        for (j = 28; j &lt; 56; ++j) &#123;</span><br><span class="line"></span><br><span class="line">            pokeBit(c[i], j, peekBit(d[i], j - 28));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* form the sub-keys and store them in &#x27;ks&#x27;</span><br><span class="line"></span><br><span class="line">    * permute &#x27;c&#x27; using table PC2 */</span><br><span class="line"></span><br><span class="line">    for (i = 1; i &lt; 17; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        for (j = 0; j &lt; 48; ++j) &#123;</span><br><span class="line"></span><br><span class="line">            pokeBit(ks[i], j, peekBit(c[i], PC2[j] - 1));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Function used in processing the messages</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* r: an array of bytes to be processed</span><br><span class="line"></span><br><span class="line">* ks: one of the subkeys to be used for processing</span><br><span class="line"></span><br><span class="line">* sp: output from the processing</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">static void f(ubyte *r, ubyte *ks, ubyte *sp) &#123;</span><br><span class="line"></span><br><span class="line">    ubyte er[6]; /* 48 bits */</span><br><span class="line"></span><br><span class="line">    ubyte sr[4]; /* 32 bits */</span><br><span class="line"></span><br><span class="line">    int i;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* initialize */</span><br><span class="line"></span><br><span class="line">    memset(er, 0, sizeof(er));</span><br><span class="line"></span><br><span class="line">    memset(sr, 0, sizeof(sr));</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* permute &#x27;r&#x27; using table E */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 48; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(er, i, peekBit(r, E[i] - 1));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* xor &#x27;er&#x27; with &#x27;ks&#x27; and store back into &#x27;er&#x27; */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 6; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        er[i] ^= ks[i];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* process &#x27;er&#x27; six bits at a time and store resulting four bits in &#x27;sr&#x27; */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 8; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        int j = i * 6;</span><br><span class="line"></span><br><span class="line">        int b[6];</span><br><span class="line"></span><br><span class="line">        int k, row, col, m, n;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        for (k = 0; k &lt; 6; ++k) &#123;</span><br><span class="line"></span><br><span class="line">            b[k] = peekBit(er, j + k) != 0 ? 1 : 0;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        row = 2 * b[0] + b[5];</span><br><span class="line"></span><br><span class="line">        col = 8 * b[1] + 4 * b[2] + 2 * b[3] + b[4];</span><br><span class="line"></span><br><span class="line">        m = S[i][row * 16 + col]; /* apply table s */</span><br><span class="line"></span><br><span class="line">        n = 1;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        while (m &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">            int p = m % 2;</span><br><span class="line"></span><br><span class="line">            pokeBit(sr, (i + 1) * 4 - n, p == 1);</span><br><span class="line"></span><br><span class="line">            m /= 2;</span><br><span class="line"></span><br><span class="line">            n++;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* permute sr using table P */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 32; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(sp, i, peekBit(sr, P[i] - 1));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Processing of block of the message</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* message: an 8 byte block from the message</span><br><span class="line"></span><br><span class="line">* ks: the subkeys to use in processing</span><br><span class="line"></span><br><span class="line">* ep: space for an encoded 8 byte block allocated by the caller</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">static void processMessage(const ubyte *message, subkey_t ks, ubyte *ep) &#123;</span><br><span class="line"></span><br><span class="line">    ubyte left[17][4];  /* 32 bits */</span><br><span class="line"></span><br><span class="line">    ubyte right[17][4]; /* 32 bits */</span><br><span class="line"></span><br><span class="line">    ubyte mp[8];        /* 64 bits */</span><br><span class="line"></span><br><span class="line">    ubyte e[8];         /* 64 bits */</span><br><span class="line"></span><br><span class="line">    int i, j;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* permute &#x27;message&#x27; using table IP */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 64; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(mp, i, peekBit(message, IP[i] - 1));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* split &#x27;mp&#x27; in half and process the resulting series of &#x27;l&#x27; and &#x27;r */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 32; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(left[0], i, peekBit(mp, i));</span><br><span class="line"></span><br><span class="line">        pokeBit(right[0], i, peekBit(mp, i + 32));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (i = 1; i &lt; 17; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        ubyte fs[4]; /* 32 bits */</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">        memcpy(left[i], right[i - 1], 4);</span><br><span class="line"></span><br><span class="line">        f(right[i - 1], ks[i], fs);</span><br><span class="line"></span><br><span class="line">        for (j = 0; j &lt; 4; ++j) &#123;</span><br><span class="line"></span><br><span class="line">            left[i - 1][j] ^= fs[j];</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        memcpy(right[i], left[i - 1], 4);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* amalgamate r[16] and l[16] (in that order) into &#x27;e&#x27; */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 32; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(e, i, peekBit(right[16], i));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (i = 32; i &lt; 64; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(e, i, peekBit(left[16], i - 32));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* permute &#x27;e&#x27; using table IP2 ad return result as a hex string */</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; 64; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        pokeBit(ep, i, peekBit(e, IP2[i] - 1));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Encrypts a message using DES</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* key: the key to use to encrypt the message</span><br><span class="line"></span><br><span class="line">* message: the message to be encrypted</span><br><span class="line"></span><br><span class="line">* len: the length of the message</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* returns: a paring of dynamically allocated memory for the encoded message,</span><br><span class="line"></span><br><span class="line">*          and the length of the encoded message.</span><br><span class="line"></span><br><span class="line">*          the caller will need to free the memory after use.</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">String encrypt(const key_t key, const ubyte *message, int len) &#123;</span><br><span class="line"></span><br><span class="line">    String result = &#123; 0, 0 &#125;;</span><br><span class="line"></span><br><span class="line">    subkey_t ks;</span><br><span class="line"></span><br><span class="line">    ubyte padByte;</span><br><span class="line"></span><br><span class="line">    int i;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    getSubKeys(key, ks);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    padByte = 8 - len % 8;</span><br><span class="line"></span><br><span class="line">    result.len = len + padByte;</span><br><span class="line"></span><br><span class="line">    result.data = (ubyte*)malloc(result.len);</span><br><span class="line"></span><br><span class="line">    memcpy(result.data, message, len);</span><br><span class="line"></span><br><span class="line">    memset(&amp;result.data[len], padByte, padByte);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; result.len; i += 8) &#123;</span><br><span class="line"></span><br><span class="line">        processMessage(&amp;result.data[i], ks, &amp;result.data[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    return result;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Decrypts a message using DES</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* key: the key to use to decrypt the message</span><br><span class="line"></span><br><span class="line">* message: the message to be decrypted</span><br><span class="line"></span><br><span class="line">* len: the length of the message</span><br><span class="line"></span><br><span class="line">*</span><br><span class="line"></span><br><span class="line">* returns: a paring of dynamically allocated memory for the decoded message,</span><br><span class="line"></span><br><span class="line">*          and the length of the decoded message.</span><br><span class="line"></span><br><span class="line">*          the caller will need to free the memory after use.</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">String decrypt(const key_t key, const ubyte *message, int len) &#123;</span><br><span class="line"></span><br><span class="line">    String result = &#123; 0, 0 &#125;;</span><br><span class="line"></span><br><span class="line">    subkey_t ks;</span><br><span class="line"></span><br><span class="line">    int i, j;</span><br><span class="line"></span><br><span class="line">    ubyte padByte;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    getSubKeys(key, ks);</span><br><span class="line"></span><br><span class="line">    /* reverse the subkeys */</span><br><span class="line"></span><br><span class="line">    for (i = 1; i &lt; 9; ++i) &#123;</span><br><span class="line"></span><br><span class="line">        for (j = 0; j &lt; 6; ++j) &#123;</span><br><span class="line"></span><br><span class="line">            ubyte temp = ks[i][j];</span><br><span class="line"></span><br><span class="line">            ks[i][j] = ks[17 - i][j];</span><br><span class="line"></span><br><span class="line">            ks[17 - i][j] = temp;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    result.data = (ubyte*)malloc(len);</span><br><span class="line"></span><br><span class="line">    memcpy(result.data, message, len);</span><br><span class="line"></span><br><span class="line">    result.len = len;</span><br><span class="line"></span><br><span class="line">    for (i = 0; i &lt; result.len; i += 8) &#123;</span><br><span class="line"></span><br><span class="line">        processMessage(&amp;result.data[i], ks, &amp;result.data[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    padByte = result.data[len - 1];</span><br><span class="line"></span><br><span class="line">    result.len -= padByte;</span><br><span class="line"></span><br><span class="line">    return result;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"></span><br><span class="line">* Convienience method for showing the round trip processing of a message</span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">void driver(const key_t key, const ubyte *message, int len) &#123;</span><br><span class="line"></span><br><span class="line">    String encoded, decoded;</span><br><span class="line"></span><br><span class="line">    char buffer[128];</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    printBytes(key, KEY_LEN, buffer);</span><br><span class="line"></span><br><span class="line">    printf(&quot;Key     : %s\n&quot;, buffer);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    printBytes(message, len, buffer);</span><br><span class="line"></span><br><span class="line">    printf(&quot;Message : %s\n&quot;, buffer);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    encoded = encrypt(key, message, len);</span><br><span class="line"></span><br><span class="line">    printBytes(encoded.data, encoded.len, buffer);</span><br><span class="line"></span><br><span class="line">    printf(&quot;Encoded : %s\n&quot;, buffer);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    decoded = decrypt(key, encoded.data, encoded.len);</span><br><span class="line"></span><br><span class="line">    printBytes(decoded.data, decoded.len, buffer);</span><br><span class="line"></span><br><span class="line">    printf(&quot;Decoded : %s\n\n&quot;, buffer);</span><br><span class="line"></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">    /* release allocated memory */</span><br><span class="line"></span><br><span class="line">    if (encoded.len &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">        free(encoded.data);</span><br><span class="line"></span><br><span class="line">        encoded.data = 0;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (decoded.len &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">        free(decoded.data);</span><br><span class="line"></span><br><span class="line">        decoded.data = 0;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*--------------------------------------------------------------------------------------------------------------*/</span><br><span class="line"></span><br><span class="line">void main()</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    String decoded;</span><br><span class="line"></span><br><span class="line">    int len;</span><br><span class="line"></span><br><span class="line">    //密钥</span><br><span class="line"></span><br><span class="line">    const key_t key = &#123;107, 101, 121, 33, 107, 101, 121, 33 &#125;;</span><br><span class="line"></span><br><span class="line">    //密文</span><br><span class="line"></span><br><span class="line">    const ubyte data[] = &#123;125, 234, 224, 219, 27, 214, 109, 85, 209, 233, 192, 113, 12, 1, 19, 43&#125;;</span><br><span class="line"></span><br><span class="line">    //密文长度</span><br><span class="line"></span><br><span class="line">    len = sizeof(data) / sizeof(ubyte);</span><br><span class="line"></span><br><span class="line">    decoded = decrypt(key, data, len);</span><br><span class="line"></span><br><span class="line">    printf(&quot;Decoded:%s\n&quot;, decoded.data);</span><br><span class="line"></span><br><span class="line">    //释放内存</span><br><span class="line"></span><br><span class="line">    if (decoded.len &gt; 0) &#123;</span><br><span class="line"></span><br><span class="line">        free(decoded.data);</span><br><span class="line"></span><br><span class="line">        decoded.data = 0;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">//sd77cfe8</span><br></pre></td></tr></table></figure>

<p>然后开始解skip32 网上找了一套python的源码 这里做了一个魔改 修改了一下key的长度 原本的skip32的key是10字节 这里修改为8字节 所以修改一下脚本 但是直接解没有解开 于是看一下so文件 发现对FTABLE进行了一些操作 修改了他原本的值</p>
<p><img src="/../images/Patr1ck-day2-wp-15.png" alt="Patr1ck-day2-wp-15"></p>
<p>所以hook一下这个FTABLE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Java.perform(function()</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">    let Skip32 = Java.use(&quot;com.ex.skip.Skip32&quot;);</span><br><span class="line"></span><br><span class="line">    var FTABLE = Skip32.FTABLE.value;</span><br><span class="line"></span><br><span class="line">    console.log(FTABLE);</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>164,216,10,132,249,73,247,245,180,34,22,121,154,178,176,250,232,46,78,139,207,77,203,47,83,150,218,31,79,57,69,41,11,224,3,161,24,242,97,105,19,184,123,196,234,251,62,84,151,133,108,187,243,100,155,26,125,175,230,246,248,23,107,163,58,183,124,16,194,148,130,28,239,181,27,235,209,146,48,185,86,186,219,134,64,66,192,225,91,89,129,96,103,12,217,145,54,214,193,168,52,7,102,106,70,1,149,87,110,153,156,119,152,253,179,195,177,255,220,33,226,236,215,229,222,72,75,30,67,238,159,111,74,61,206,68,40,211,8,213,223,200,104,25,138,204,49,32,142,199,144,171,201,117,221,202,94,93,50,165,113,137,98,45,160,14,44,136,81,131,85,101,39,126,4,65,53,76,29,116,210,197,254,60,205,252,128,172,231,63,92,166,174,5,36,157,21,82,35,241,42,122,114,127,0,141,15,227,13,240,189,115,118,112,56,162,237,212,143,99,140,135,17,233,9,120,18,191,147,80,37,198,51,55,158,208,244,167,188,173,95,109,170,20,88,38,182,228,190,169,59,2,6,90,43,71</code></p>
<p>再去解密还是解不开 运行了一下之前解密用户名的脚本 发现每次生成用户名的第一个字符不一样</p>
<p><img src="/../images/Patr1ck-day2-wp-14.png" alt="Patr1ck-day2-wp-14"></p>
<p>这里我直接暴力猜测第一个字符了 从0开始 尝试到7的时候 发现可以正确解出密码 所以用户名就是7d77cfe8</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">import struct  </span><br><span class="line">FTABLE = (  </span><br><span class="line">    164, 216, 10, 132, 249, 73, 247, 245, 180, 34, 22, 121, 154, 178, 176, 250, 232, 46, 78, 139, 207, 77, 203, 47, 83, 150,  </span><br><span class="line">    218, 31, 79, 57, 69, 41, 11, 224, 3, 161, 24, 242, 97, 105, 19, 184, 123, 196, 234, 251, 62, 84, 151, 133, 108, 187,  </span><br><span class="line">    243, 100, 155, 26, 125, 175, 230, 246, 248, 23, 107, 163, 58, 183, 124, 16, 194, 148, 130, 28, 239, 181, 27, 235, 209,  </span><br><span class="line">    146, 48, 185, 86, 186, 219, 134, 64, 66, 192, 225, 91, 89, 129, 96, 103, 12, 217, 145, 54, 214, 193, 168, 52, 7, 102,  </span><br><span class="line">    106, 70, 1, 149, 87, 110, 153, 156, 119, 152, 253, 179, 195, 177, 255, 220, 33, 226, 236, 215, 229, 222, 72, 75, 30, 67,  </span><br><span class="line">    238, 159, 111, 74, 61, 206, 68, 40, 211, 8, 213, 223, 200, 104, 25, 138, 204, 49, 32, 142, 199, 144, 171, 201, 117, 221,  </span><br><span class="line">    202, 94, 93, 50, 165, 113, 137, 98, 45, 160, 14, 44, 136, 81, 131, 85, 101, 39, 126, 4, 65, 53, 76, 29, 116, 210, 197,  </span><br><span class="line">    254, 60, 205, 252, 128, 172, 231, 63, 92, 166, 174, 5, 36, 157, 21, 82, 35, 241, 42, 122, 114, 127, 0, 141, 15, 227, 13,  </span><br><span class="line">    240, 189, 115, 118, 112, 56, 162, 237, 212, 143, 99, 140, 135, 17, 233, 9, 120, 18, 191, 147, 80, 37, 198, 51, 55, 158,  </span><br><span class="line">    208, 244, 167, 188, 173, 95, 109, 170, 20, 88, 38, 182, 228, 190, 169, 59, 2, 6, 90, 43, 71)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">def g(key, k, w):  </span><br><span class="line">    g1 = 0xFF &amp; (w &gt;&gt; 8)  </span><br><span class="line">    g2 = 0xFF &amp; w  </span><br><span class="line">  </span><br><span class="line">    g3 = FTABLE[g2 ^ key[(4 * k + 0) % 8]] ^ g1  </span><br><span class="line">    g4 = FTABLE[g3 ^ key[(4 * k + 1) % 8]] ^ g2  </span><br><span class="line">    g5 = FTABLE[g4 ^ key[(4 * k + 2) % 8]] ^ g3  </span><br><span class="line">    g6 = FTABLE[g5 ^ key[(4 * k + 3) % 8]] ^ g4  </span><br><span class="line">  </span><br><span class="line">    return ((g5 &lt;&lt; 8) + g6)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">def skip32(key, buf, encrypt):  </span><br><span class="line">    # sort out direction  </span><br><span class="line">    if encrypt:  </span><br><span class="line">        k, step = 0, 1  </span><br><span class="line">    else:  </span><br><span class="line">        k, step = 23, -1  </span><br><span class="line">  </span><br><span class="line">    # pack into words  </span><br><span class="line">    wl = (buf[0] &lt;&lt; 8) + buf[1]  </span><br><span class="line">    wr = (buf[2] &lt;&lt; 8) + buf[3]  </span><br><span class="line">  </span><br><span class="line">    # 24 feistel rounds, doubled up  </span><br><span class="line">    for _ in range(12):  </span><br><span class="line">        wr ^= g(key, k, wl) ^ k  </span><br><span class="line">        k += step  </span><br><span class="line">        wl ^= g(key, k, wr) ^ k  </span><br><span class="line">        k += step  </span><br><span class="line">  </span><br><span class="line">    # implicitly swap halves while unpacking  </span><br><span class="line">    buf[0] = (wr &gt;&gt; 8)  </span><br><span class="line">    buf[1] = (wr &amp; 0xFF)  </span><br><span class="line">    buf[2] = (wl &gt;&gt; 8)  </span><br><span class="line">    buf[3] = (wl &amp; 0xFF)  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">def decrypt(key, value):  </span><br><span class="line">    buf = [  </span><br><span class="line">        (value &gt;&gt; 24) &amp; 0xff,  </span><br><span class="line">        (value &gt;&gt; 16) &amp; 0xff,  </span><br><span class="line">        (value &gt;&gt; 8) &amp; 0xff,  </span><br><span class="line">        (value &gt;&gt; 0) &amp; 0xff,  </span><br><span class="line">    ]  </span><br><span class="line">    skip32(key, buf, False)  </span><br><span class="line">    return (buf[0] &lt;&lt; 24) | (buf[1] &lt;&lt; 16) | (buf[2] &lt;&lt; 8) | buf[3]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line">key = b&quot;7d77cfe8&quot;  </span><br><span class="line">encrypted = [52, 142, 226, 172, 108, 94, 80, 51, 11, 251, 68, 164, 231, 6, 124, 223, 100, 62, 116, 70]  </span><br><span class="line">  </span><br><span class="line">  </span><br><span class="line"># Decrypt the encrypted values  </span><br><span class="line">for i in range(0, 20, 4):  </span><br><span class="line">    password = (encrypted[i] &lt;&lt; 24) | (encrypted[i + 1] &lt;&lt; 16) | (encrypted[i + 2] &lt;&lt; 8) | (encrypted[i + 3])  </span><br><span class="line">    decrypted_password = decrypt(key,password)  </span><br><span class="line">    encrypted[i] = (decrypted_password &gt;&gt; 24) &amp; 0xff  </span><br><span class="line">    encrypted[i + 1] = (decrypted_password &gt;&gt; 16) &amp; 0xff  </span><br><span class="line">    encrypted[i + 2] = (decrypted_password &gt;&gt; 8) &amp; 0xff  </span><br><span class="line">    encrypted[i + 3] = decrypted_password &amp; 0xff  </span><br><span class="line">  </span><br><span class="line">result = &#x27;&#x27;.join(chr(password) for password in encrypted)  </span><br><span class="line">print(result)  </span><br><span class="line">#c58b6a2f988bc9434a45</span><br></pre></td></tr></table></figure>

<p>成功拿到flag</p>
<p><img src="/../images/Patr1ck-day2-wp-16.png" alt="Patr1ck-day2-wp-16"></p>
<h1 id="Nu1tka"><a href="#Nu1tka" class="headerlink" title="Nu1tka"></a>Nu1tka</h1><p>逻辑很简单 调试过程很折磨人<br>ida打开附件 发现是一个跳板程序 直接打个断点找到真正的程序</p>
<p><img src="/../images/Patr1ck-day2-wp-17.png" alt="Patr1ck-day2-wp-17"></p>
<p><img src="/../images/Patr1ckday2wp-17.png" alt="Patr1ckday2wp-17"></p>
<p>dump下来 ida打开dump下来的Nu1tka.exe 交叉引用_main_字符串以及动态调试 定位到关键函数</p>
<p><img src="/../images/Patr1ckday2wp-18.png" alt="Patr1ckday2wp-18"></p>
<p>随后一点一点看 分析main_0<br>这里计算了长度并且比较 得知flag长度是40</p>
<p><img src="/../images/Patr1ckday2wp-19.png" alt="Patr1ckday2wp-19"></p>
<p><img src="/../images/Patr1ckday2wp-20.png" alt="Patr1ckday2wp-20"></p>
<p>这里将输入的flag每4位转化为bytes 所以key跟enc应该是每个数组10个元素</p>
<p><img src="/../images/Patr1ckday2wp-21.png" alt="Patr1ckday2wp-21"></p>
<p>经过反复的调试 找到enc跟key 提取出来</p>
<p><img src="/../images/Patr1ckday2wp-22.png" alt="Patr1ckday2wp-22"></p>
<p>最后的加密 enc跟key异或</p>
<p><img src="/../images/Patr1ckday2wp-23.png" alt="Patr1ckday2wp-23"></p>
<p>写脚本求一下<br>发现有别的多余的字符 在程序中没发现别的运算 只有xor 所以根据文件头计算一下那些乱码异或的值 得到flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from Crypto.Util.number import *  </span><br><span class="line">key = [0x35138033, 0x185A0194, 0x34C41B8F, 0x0B1E6089, 0x0DB7419B, 0x1C6873F3, 0x049FAA92, 0x30D6B47E, 0x23AD4395, 0x33EA34C7]  </span><br><span class="line">enc = [0x1272EC55, 0x286F64EF, 0x0CA02DED, 0x3A2A4DEF, 0x299A25FA, 0x310B4BC2, 0x22A89BF4, 0x12E28553, 0x109920A3, 0x0EDD52A6]  </span><br><span class="line">flag = &quot;&quot;.join(long_to_bytes(e ^ k)[::-1].decode(&#x27;utf-8&#x27;) for e, k in zip(enc, key))  </span><br><span class="line">print(flag)  </span><br><span class="line">print((ord(&#x27;=&#x27;) ^ ord(&#x27;&#125;&#x27;)))  # 64  </span><br><span class="line">for c in &quot;\&#x27;$&amp;\&quot;&quot;:  </span><br><span class="line">    print(chr(ord(c) ^ 64))  </span><br><span class="line">#flag&#123;e50b6d8f-41ad-d18c-f17f-14b6c43af7&#125;</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2025/01/27/2025-%E7%AC%AC%E4%B8%80%E5%B1%8A%E5%90%AF%E8%88%AA%E6%9D%AF-RE-wp/" rel="prev" title="2025 第一届启航杯 RE wp">
                  <i class="fa fa-angle-left"></i> 2025 第一届启航杯 RE wp
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2025/02/17/2025-BroncoCTF-RE-wp/" rel="next" title="2025 BroncoCTF RE wp">
                  2025 BroncoCTF RE wp <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Patr1ck</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">90k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">1:21</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
<!--
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>
-->

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
